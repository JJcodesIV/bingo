<!DOCTYPE html><html lang="en"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bingo Board Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Inter',system-ui,sans-serif;background:#f1f5f9;color:#1e293b;line-height:1.5;min-height:100vh}
.app{max-width:1080px;margin:0 auto;padding:24px 16px 60px}
header{text-align:center;margin-bottom:28px}
header .icon{font-size:44px;margin-bottom:4px}
header h1{font-size:clamp(22px,4vw,32px);font-weight:800;color:#4338ca;letter-spacing:-0.5px}
header p{color:#64748b;font-size:15px;margin-top:2px}
.config-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px}
@media(max-width:700px){.config-grid{grid-template-columns:1fr}}
.card{background:#fff;border-radius:14px;padding:22px;box-shadow:0 1px 3px rgba(0,0,0,.06),0 4px 16px rgba(0,0,0,.03)}
.card h2{font-size:16px;font-weight:700;margin-bottom:14px;display:flex;align-items:center;gap:8px;color:#334155}
.form-group{margin-bottom:14px}
.form-group > label{display:block;font-size:11.5px;font-weight:700;color:#475569;margin-bottom:5px;text-transform:uppercase;letter-spacing:.6px}
.form-group input[type="text"],.form-group input[type="number"]{width:100%;padding:9px 12px;border:2px solid #e2e8f0;border-radius:9px;font-size:14px;font-family:inherit;outline:none;transition:border .2s}
.form-group input:focus{border-color:#6366f1}
.size-selector{display:flex;gap:6px}
.size-btn{flex:1;padding:9px 6px;border:2px solid #e2e8f0;border-radius:9px;background:#fff;font-size:14px;font-weight:600;cursor:pointer;transition:all .15s;font-family:inherit}
.size-btn:hover{border-color:#6366f1;background:#eef2ff}
.size-btn.active{border-color:#4338ca;background:#4338ca;color:#fff}
.cb-group label{display:flex;align-items:center;gap:9px;cursor:pointer;font-size:14px;font-weight:500;color:#475569}
.cb-group input[type="checkbox"]{width:18px;height:18px;accent-color:#4338ca;cursor:pointer}
.cb-group.disabled{opacity:.35;pointer-events:none}
.entry-info{font-size:13px;color:#64748b;margin-bottom:10px}
.entry-info strong{color:#4338ca;font-weight:700}
textarea{width:100%;padding:10px 12px;border:2px solid #e2e8f0;border-radius:9px;font-size:13px;font-family:inherit;line-height:1.6;resize:vertical;outline:none;transition:border .2s;min-height:180px}
textarea:focus{border-color:#6366f1}
.entry-footer{display:flex;justify-content:space-between;align-items:center;margin-top:10px;flex-wrap:wrap;gap:8px}
.badge{display:inline-block;padding:3px 12px;border-radius:20px;font-size:12px;font-weight:700}
.badge.ok{background:#dcfce7;color:#16a34a}
.badge.bad{background:#fee2e2;color:#dc2626}
.btn{padding:11px 26px;border:none;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer;font-family:inherit;transition:all .15s;display:inline-flex;align-items:center;gap:8px}
.btn:disabled{opacity:.45;cursor:not-allowed;transform:none!important;box-shadow:none!important}
.btn-sm{padding:7px 14px;font-size:12px;border-radius:8px}
.btn-primary{background:#4338ca;color:#fff}
.btn-primary:hover:not(:disabled){background:#3730a3;transform:translateY(-1px);box-shadow:0 4px 14px rgba(67,56,202,.35)}
.btn-success{background:#059669;color:#fff}
.btn-success:hover:not(:disabled){background:#047857;transform:translateY(-1px);box-shadow:0 4px 14px rgba(5,150,105,.35)}
.btn-ghost{background:#f1f5f9;color:#475569}
.btn-ghost:hover{background:#e2e8f0}
.action-bar{display:flex;gap:10px;justify-content:center;margin-bottom:28px;flex-wrap:wrap}
.preview-section{margin-top:4px}
.preview-section h2{font-size:20px;font-weight:700;text-align:center;margin-bottom:6px;color:#334155}
.preview-nav{display:flex;justify-content:center;align-items:center;gap:14px;margin-bottom:18px}
.preview-nav button{padding:7px 14px;border:2px solid #e2e8f0;border-radius:8px;background:#fff;cursor:pointer;font-family:inherit;font-weight:600;font-size:13px;transition:all .15s}
.preview-nav button:hover:not(:disabled){border-color:#6366f1;color:#4338ca}
.preview-nav button:disabled{opacity:.3;cursor:not-allowed}
.preview-nav span{font-weight:600;color:#64748b;font-size:14px;min-width:110px;text-align:center}
.board-wrap{display:flex;justify-content:center}
.bingo-board{background:#fff;border-radius:14px;padding:20px;box-shadow:0 4px 24px rgba(0,0,0,.07);display:inline-block;max-width:100%}
.board-title{text-align:center;font-size:clamp(18px,3vw,26px);font-weight:800;color:#4338ca;margin-bottom:2px;letter-spacing:6px}
.board-number{text-align:center;font-size:12px;color:#94a3b8;margin-bottom:12px;font-weight:600}
.board-header{display:grid;gap:0}
.board-header-cell{background:#1e1b4b;color:#fff;font-weight:700;text-align:center;padding:8px 2px;font-size:15px}
.board-header-cell:first-child{border-radius:6px 0 0 0}
.board-header-cell:last-child{border-radius:0 6px 0 0}
.board-grid{display:grid;border:2.5px solid #1e1b4b;border-top:none;border-radius:0 0 6px 6px;overflow:hidden}
.board-grid.no-header{border-top:2.5px solid #1e1b4b;border-radius:6px;overflow:hidden}
.board-cell{border:1px solid #c7d2fe;display:flex;align-items:center;justify-content:center;text-align:center;padding:5px;font-size:12px;font-weight:500;background:#fff;word-break:break-word;aspect-ratio:1;line-height:1.25;overflow:hidden}
.board-cell.free{background:#eef2ff;font-weight:700;color:#4338ca;font-size:14px}
.toast{position:fixed;top:18px;right:18px;padding:14px 22px;border-radius:10px;font-weight:600;font-size:13px;z-index:9999;transform:translateX(140%);transition:transform .3s cubic-bezier(.4,0,.2,1);max-width:340px;box-shadow:0 8px 24px rgba(0,0,0,.12)}
.toast.show{transform:translateX(0)}
.toast.error{background:#fef2f2;color:#dc2626;border:2px solid #fca5a5}
.toast.success{background:#f0fdf4;color:#15803d;border:2px solid #86efac}
.toast.info{background:#eff6ff;color:#2563eb;border:2px solid #93c5fd}
.sample-link{font-size:12px;color:#6366f1;cursor:pointer;text-decoration:underline;font-weight:600;background:none;border:none;font-family:inherit}
.sample-link:hover{color:#4338ca}
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="icon">üéØ</div>
    <h1>Bingo Board Generator</h1>
    <p>Create unique randomized boards for every team member</p>
  </header>
  <div class="config-grid">
    <div class="card">
      <h2>‚öôÔ∏è Settings</h2>
      <div class="form-group">
        <label>Board Title</label>
        <input type="text" id="boardTitle" value="BINGO" maxlength="40" placeholder="e.g. BINGO">
      </div>
      <div class="form-group">
        <label>Board Size</label>
        <div class="size-selector">
          <button class="size-btn" data-s="3" onclick="setSize(3)">3√ó3</button>
          <button class="size-btn" data-s="4" onclick="setSize(4)">4√ó4</button>
          <button class="size-btn active" data-s="5" onclick="setSize(5)">5√ó5</button>
        </div>
      </div>
      <div class="form-group">
        <label>Number of Boards</label>
        <input type="number" id="numBoards" value="6" min="1" max="100">
      </div>
      <div class="form-group cb-group" id="freeGroup">
        <label><input type="checkbox" id="freeSpace" checked="" onchange="updateReq()"><span>Free center space</span></label>
      </div>
      <div class="form-group cb-group">
        <label><input type="checkbox" id="nameLine" checked=""><span>Include name line on PDF</span></label>
      </div>
    </div>
    <div class="card">
      <h2>üìù Entries</h2>
      <p class="entry-info">One item per line ‚Äî need at least <strong id="reqNum">24</strong>.
        <button class="sample-link" onclick="loadSamples()">Load samples</button>
      </p>
      <textarea id="entriesInput" placeholder="Type your bingo entries here, one per line‚Ä¶" oninput="updateCount()"></textarea>
      <div class="entry-footer">
        <span class="badge bad" id="countBadge">0 / 24</span>
        <button class="btn btn-ghost btn-sm" onclick="clearEntries()">Clear All</button>
      </div>
    </div>
  </div>
  <div class="action-bar">
    <button class="btn btn-primary" onclick="generate()">üé≤ Generate Boards</button>
    <button class="btn btn-success" id="exportBtn" onclick="exportPDF()" disabled="">üìÑ Export as PDF</button>
  </div>
  <section id="previewSec" class="preview-section" style="display:none">
    <h2>üìã Board Preview</h2>
    <div class="preview-nav">
      <button id="prevB" onclick="nav(-1)">‚Üê Prev</button>
      <span id="navLabel">Board 1 of 6</span>
      <button id="nextB" onclick="nav(1)">Next ‚Üí</button>
    </div>
    <div class="board-wrap" id="boardWrap"></div>
  </section>
</div>
<div class="toast" id="toast"></div>

<script>
let SIZE=5, boards=[], curIdx=0;

const $=id=>document.getElementById(id);
const esc=t=>{const d=document.createElement('div');d.textContent=t;return d.innerHTML};

function toast(msg,type='info'){
  const t=$('toast');t.textContent=msg;t.className='toast '+type;
  setTimeout(()=>t.classList.add('show'),20);
  setTimeout(()=>t.classList.remove('show'),3200);
}

function getReq(){
  const free=$('freeSpace').checked&&SIZE%2===1;
  return free?SIZE*SIZE-1:SIZE*SIZE;
}

function entries(){
  return $('entriesInput').value.split('\n').map(s=>s.trim()).filter(s=>s);
}

function updateReq(){
  const r=getReq();
  $('reqNum').textContent=r;
  updateCount();
}

function updateCount(){
  const n=entries().length,r=getReq(),b=$('countBadge');
  b.textContent=n+' / '+r;
  b.className='badge '+(n>=r?'ok':'bad');
}

function setSize(s){
  SIZE=s;
  document.querySelectorAll('.size-btn').forEach(b=>b.classList.toggle('active',+b.dataset.s===s));
  const fg=$('freeGroup');
  if(s%2===0){fg.classList.add('disabled');$('freeSpace').checked=false}
  else{fg.classList.remove('disabled');$('freeSpace').checked=true}
  updateReq();
  boards=[];curIdx=0;
  $('previewSec').style.display='none';
  $('exportBtn').disabled=true;
}

function clearEntries(){$('entriesInput').value='';updateCount()}

function loadSamples(){
  const s=SIZE===3?[
    "Coffee lover","Dog person","Cat person","Early bird","Night owl",
    "Has a tattoo","Plays an instrument","Speaks 2+ languages","Loves hiking",
    "Born in another state","Has twins","Reads daily"
  ]:SIZE===4?[
    "Coffee lover","Dog person","Cat person","Early bird","Night owl",
    "Has a tattoo","Plays an instrument","Speaks 2+ languages","Loves hiking",
    "Born in another state","Reads daily","Binge watcher","Works remote",
    "Has traveled abroad","Loves cooking","Morning jogger","Plant parent","Gamer"
  ]:[
    "Coffee lover","Dog person","Cat person","Early bird","Night owl",
    "Has a tattoo","Plays an instrument","Speaks 2+ languages","Loves hiking",
    "Born in another state","Reads daily","Binge watcher","Works remote",
    "Has traveled abroad","Loves cooking","Morning jogger","Plant parent","Gamer",
    "Sings in the car","Collects something","Has a hidden talent","Volunteers",
    "Loves spicy food","Has met someone famous","Marathon runner","Crafty person",
    "Plays board games","Tea over coffee","Has a pet fish","Writes poetry"
  ];
  $('entriesInput').value=s.join('\n');
  updateCount();
}

function shuffle(a){const s=[...a];for(let i=s.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[s[i],s[j]]=[s[j],s[i]]}return s}

function makeBoard(ents){
  const total=SIZE*SIZE, free=$('freeSpace').checked&&SIZE%2===1;
  const need=free?total-1:total;
  const picked=shuffle(ents).slice(0,need);
  const board=[];const center=Math.floor(total/2);
  let ei=0;
  for(let i=0;i<total;i++){
    if(free&&i===center) board.push({text:'FREE',free:true});
    else board.push({text:picked[ei++],free:false});
  }
  return board;
}

function generate(){
  const ents=entries(),req=getReq(),num=Math.min(Math.max(+$('numBoards').value||1,1),100);
  if(ents.length<req){toast(`Need at least ${req} entries ‚Äî you have ${ents.length}.`,'error');return}
  boards=[];
  for(let i=0;i<num;i++) boards.push(makeBoard(ents));
  curIdx=0;
  $('previewSec').style.display='';
  $('exportBtn').disabled=false;
  renderBoard();
  toast(`${num} board${num>1?'s':''} generated!`,'success');
  $('previewSec').scrollIntoView({behavior:'smooth',block:'start'});
}

function renderBoard(){
  const b=boards[curIdx], title=$('boardTitle').value.trim()||'BINGO';
  $('navLabel').textContent=`Board ${curIdx+1} of ${boards.length}`;
  $('prevB').disabled=curIdx===0;
  $('nextB').disabled=curIdx===boards.length-1;

  const showHeader=title.length===SIZE;
  let h=`<div class="bingo-board"><div class="board-title">${esc(title)}</div><div class="board-number">Board #${curIdx+1}</div>`;

  if(showHeader){
    h+=`<div class="board-header" style="display:grid;grid-template-columns:repeat(${SIZE},1fr)">`;
    for(const ch of title) h+=`<div class="board-header-cell">${esc(ch)}</div>`;
    h+=`</div>`;
  }

  h+=`<div class="board-grid ${showHeader?'':'no-header'}" style="grid-template-columns:repeat(${SIZE},1fr)">`;
  const fs=SIZE===3?14:SIZE===4?13:12;
  b.forEach(c=>{
    h+=`<div class="board-cell${c.free?' free':''}" style="font-size:${c.free?fs+1:fs}px">${esc(c.text)}</div>`;
  });
  h+=`</div></div>`;
  $('boardWrap').innerHTML=h;
}

function nav(d){curIdx=Math.max(0,Math.min(boards.length-1,curIdx+d));renderBoard()}

/* ===== PDF EXPORT ===== */
function exportPDF(){
  if(!boards.length){toast('Generate boards first!','error');return}
  const{jsPDF}=window.jspdf;
  const doc=new jsPDF({orientation:'portrait',unit:'mm',format:'letter'});
  const pw=doc.internal.pageSize.getWidth();
  const ph=doc.internal.pageSize.getHeight();
  const title=($('boardTitle').value.trim()||'BINGO');
  const showName=$('nameLine').checked;
  const cellSizes={3:46,4:38,5:31};
  const cs=cellSizes[SIZE];
  const bw=cs*SIZE;
  const sx=(pw-bw)/2;
  const headerH=10;
  const showColH=title.length===SIZE;
  const ptMM=0.3528;

  boards.forEach((board,bi)=>{
    if(bi>0) doc.addPage();

    /* title */
    doc.setFont('helvetica','bold');doc.setFontSize(26);doc.setTextColor(67,56,202);
    doc.text(title,pw/2,26,{align:'center',charSpace:4});

    /* board number */
    doc.setFont('helvetica','normal');doc.setFontSize(10);doc.setTextColor(148,163,184);
    doc.text('Board #'+(bi+1),pw/2,34,{align:'center'});

    let gridY=42;

    /* column header bar */
    if(showColH){
      doc.setFillColor(30,27,75);
      doc.rect(sx,gridY,bw,headerH,'F');
      doc.setFont('helvetica','bold');doc.setFontSize(14);doc.setTextColor(255,255,255);
      for(let i=0;i<SIZE;i++){
        doc.text(title[i],sx+i*cs+cs/2,gridY+headerH/2+1.8,{align:'center'});
      }
      gridY+=headerH;
    }

    /* cells */
    for(let r=0;r<SIZE;r++){
      for(let c=0;c<SIZE;c++){
        const ci=r*SIZE+c;
        const cell=board[ci];
        const cx=sx+c*cs, cy=gridY+r*cs;

        /* fill */
        if(cell.free){doc.setFillColor(238,242,255)}else{doc.setFillColor(255,255,255)}
        doc.rect(cx,cy,cs,cs,'F');

        /* border */
        doc.setDrawColor(199,210,254);doc.setLineWidth(.25);
        doc.rect(cx,cy,cs,cs,'S');

        /* text */
        if(cell.free){
          doc.setFont('helvetica','bold');doc.setFontSize(13);doc.setTextColor(67,56,202);
          doc.text('FREE',cx+cs/2,cy+cs/2+1.5,{align:'center'});
          /* star decorations */
          doc.setFontSize(8);
          doc.text('\u2605',cx+cs/2-10,cy+cs/2+1.5,{align:'center'});
          doc.text('\u2605',cx+cs/2+10,cy+cs/2+1.5,{align:'center'});
        } else {
          doc.setTextColor(30,30,46);doc.setFont('helvetica','normal');
          let fs=SIZE===3?11:SIZE===4?10:9;
          doc.setFontSize(fs);
          const mw=cs-5;
          let lines=doc.splitTextToSize(cell.text,mw);
          if(lines.length>3&&fs>7){fs-=2;doc.setFontSize(fs);lines=doc.splitTextToSize(cell.text,mw)}
          if(lines.length>4) lines=lines.slice(0,4);
          const lh=fs*1.18*ptMM;
          const bh=(lines.length-1)*lh;
          const ty=cy+cs/2-bh/2+fs*ptMM*.35;
          lines.forEach((ln,li)=>doc.text(ln,cx+cs/2,ty+li*lh,{align:'center'}));
        }
      }
    }

    /* outer border */
    doc.setDrawColor(30,27,75);doc.setLineWidth(1.2);
    doc.rect(sx,gridY,bw,cs*SIZE,'S');
    if(showColH){
      doc.setLineWidth(1.2);
      doc.rect(sx,gridY-headerH,bw,headerH+cs*SIZE,'S');
    }

    /* name line */
    if(showName){
      const ny=gridY+cs*SIZE+18;
      doc.setFont('helvetica','normal');doc.setFontSize(11);doc.setTextColor(71,85,105);
      doc.text('Name:',sx,ny);
      doc.setDrawColor(148,163,184);doc.setLineWidth(.4);
      doc.line(sx+18,ny,sx+bw,ny);
    }

    /* rules */
    const ry=gridY+cs*SIZE+(showName?30:18);
    doc.setFont('helvetica','italic');doc.setFontSize(8.5);doc.setTextColor(148,163,184);
    doc.text('Mark each square when you spot the item. Complete a full row, column, or diagonal to win!',pw/2,ry,{align:'center'});

    /* page num */
    doc.setFont('helvetica','normal');doc.setFontSize(8);doc.setTextColor(180,180,180);
    doc.text('Page '+(bi+1)+' of '+boards.length,pw/2,ph-12,{align:'center'});
  });

  const fn=title.replace(/[^a-zA-Z0-9]+/g,'_')+'_bingo_boards.pdf';
  doc.save(fn);
  toast('PDF saved: '+fn,'success');
}

/* init */
updateReq();
</script>


</body></html>
